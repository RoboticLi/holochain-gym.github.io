<!DOCTYPE html><html lang="en" dir="ltr"><head>
  
    

  



<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic: Validation: Holochain Gym</title>
<meta property="og:title" content="Basic: Validation: Holochain Gym">

<meta name="generator" content="rocket 0.1">
<link rel="canonical" href="/developers/basic/validation/">



<meta name="description" content="Holochain Gym contains exercises, resources and trainings to learn holochain">
<meta property="og:description" content="Holochain Gym contains exercises, resources and trainings to learn holochain">

  
    <link rel="apple-touch-icon" sizes="180x180" href="../../../assets/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../../assets/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../../../assets/favicon-16x16.png">
<link rel="manifest" href="../../../assets/webmanifest.json">
<link rel="mask-icon" href="../../../assets/safari-pinned-tab.svg" color="#3f93ce">
<meta name="msapplication-TileColor" content="#1d3557">
<meta name="theme-color" content="#1d3557">

  
    <meta property="og:site_name" content="Holochain Gym">
<meta property="og:type" content="website">

<meta property="og:image" content="../../../649a55e1.png">
<meta property="og:url" content="/developers/basic/validation/">

<meta name="twitter:card" content="summary_large_image">

  
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="">

<link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;700&amp;display=optional" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&amp;display=optional" rel="stylesheet">

<style>
  body {
    font-family: Arial !important;
  }
</style>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  
    <link rel="stylesheet" href="../../../be94ee0c.css">
<link rel="stylesheet" href="../../../0f4765a3.css">
<link rel="stylesheet" href="../../../ac2ea3b8.css">
<link rel="stylesheet" href="../../../b8c01bc2.css">

  
    <noscript><link rel="stylesheet" href="/_merged_assets/_static/noscript.css"/></noscript>

  

<link rel="preload" href="../../../81b16c1a.js" as="script" crossorigin="anonymous">
<link rel="preload" href="../../../962426a7.js" as="script" crossorigin="anonymous">
<link rel="preload" href="../../../d15d5a5d.js" as="script" crossorigin="anonymous">
</head>

  

  
  <body layout="layout-sidebar">
  

    
      <header id="main-header">
  <div class="content-area">
    
      <button id="mobile-menu-trigger" data-action="trigger-mobile-menu">
	<span class="sr-only">Show Menu</span>
	      <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon">
        <path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path>
      </svg>

</button>

    
      
	<a class="logo-link" href="/">
  <img src="../../../a9d80dbb.svg" alt="A gym tool">
  <span>Holochain Gym</span>
</a>



    
      
  <a href="/concepts/" class="
          
          
        ">Concepts</a>
  <a href="/developers/" class="
          
           active 
        ">Developers</a>
  <a href="/whatsnext/" class="
          
          
        ">What's next</a>

    
      <a href="https://developer.holochain.org/docs/glossary/" class="">Glossary of Terms</a>
    
      <launch-dark-switch class="light-dark-switch" label="Toggle darkmode">Toggle darkmode</launch-dark-switch>


    
      <a href="https://forum.holochain.org/c/learning-library/gym/133" class="">Give us Feedback!</a>
    
      
	<a class="social-link" href="https://github.com/holochain-gym/" aria-label="Holochain Gym on GitHub" rel="noopener noreferrer" target="_blank">
		<span class="sr-only">GitHub</span>
		
			<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 17 16" fill="none">
  <title>GitHub</title>
  <path fill="currentColor" fill-rule="evenodd" d="M8.18391.249268C3.82241.249268.253906 3.81777.253906 8.17927c0 3.46933 2.279874 6.44313 5.451874 7.53353.3965.0991.49563-.1983.49563-.3965v-1.3878c-2.18075.4956-2.67638-.9912-2.67638-.9912-.3965-.8922-.89212-1.1895-.89212-1.1895-.69388-.4957.09912-.4957.09912-.4957.793.0992 1.1895.793 1.1895.793.69388 1.2887 1.88338.8922 2.27988.6939.09912-.4956.29737-.8921.49562-1.0904-1.78425-.1982-3.5685-.8921-3.5685-3.96496 0-.89212.29738-1.586.793-2.08162-.09912-.19825-.3965-.99125.09913-2.08163 0 0 .69387-.19825 2.18075.793.59475-.19825 1.28862-.29737 1.9825-.29737.69387 0 1.38775.09912 1.98249.29737 1.4869-.99125 2.1808-.793 2.1808-.793.3965 1.09038.1982 1.88338.0991 2.08163.4956.59475.793 1.28862.793 2.08162 0 3.07286-1.8834 3.66766-3.66764 3.86586.29737.3965.59474.8921.59474 1.586v2.1808c0 .1982.0991.4956.5948.3965 3.172-1.0904 5.4518-4.0642 5.4518-7.53353-.0991-4.3615-3.6676-7.930002-8.02909-7.930002z" clip-rule="evenodd"></path>
</svg>

		
	</a>

    
  </div>
</header>

    

    
  <div id="content-wrapper">
    <div class="content-area">
      
        <rocket-drawer id="sidebar">
  <nav slot="content" id="sidebar-nav">
    
      <a class="logo-link" href="/">
  <img src="../../../a9d80dbb.svg" alt="A gym tool">
  <span>Holochain Gym</span>
</a>


    
      <rocket-navigation>
  <ul><li class="menu-item">
<a href="/developers/requirements/">Requirements</a>
<ul><li class="menu-item">
<a href="/developers/requirements/setup/">Setup</a>

</li>
<li class="menu-item">
<a href="/developers/requirements/documentation/">Documentation</a>

</li>
<li class="menu-item">
<a href="/developers/requirements/rust/">Rust</a>

</li>
<li class="menu-item">
<a href="/developers/requirements/anatomy/">Anatomy</a>

</li></ul>
</li>
<li class="menu-item active">
<a href="/developers/basic/">Basic</a>
<ul><li class="menu-item">
<a href="/developers/basic/zome-functions/">Zome functions</a>

</li>
<li class="menu-item">
<a href="/developers/basic/entries/">Creating Entries</a>

</li>
<li class="menu-item">
<a href="/developers/basic/hashes/">Playing with Hashes</a>

</li>
<li class="menu-item">
<a href="/developers/basic/links/">Attaching Links</a>

</li>
<li class="menu-item">
<a href="/developers/basic/source-chain/">Querying the Source Chain</a>

</li>
<li class="menu-item">
<a href="/developers/basic/elements/">Getting Elements</a>

</li>
<li class="menu-item current">
<a href="/developers/basic/validation/">Validation</a>
<ul>
  <li class="menu-item anchor">
    <a href="#background" class="anchor">Background</a>
  </li>
  <li class="menu-item anchor">
    <a href="#about-validation" class="anchor">About validation</a>
  </li>
  <li class="menu-item anchor">
    <a href="#exercise" class="anchor">Exercise</a>
  </li>
</ul>

</li></ul>
</li>
<li class="menu-item">
<a href="/developers/intermediate/">Intermediate</a>
<ul><li class="menu-item">
<a href="/developers/intermediate/anchors/">Anchors</a>

</li>
<li class="menu-item">
<a href="/developers/intermediate/paths/">Paths</a>

</li>
<li class="menu-item">
<a href="/developers/intermediate/delete/">Delete</a>

</li>
<li class="menu-item">
<a href="/developers/intermediate/update/">Update</a>

</li>
<li class="menu-item">
<a href="/developers/intermediate/call-remote/">Remote Call</a>

</li>
<li class="menu-item">
<a href="/developers/intermediate/capability-tokens/">Capability Tokens</a>

</li>
<li class="menu-item">
<a href="/developers/intermediate/private-entry/">Private entry</a>

</li></ul>
</li>
<li class="menu-item">
<a href="/developers/advanced/">Advanced</a>

</li></ul>
  <div class="sidebar-bottom">
  <hr> <launch-dark-switch class="light-dark-switch" label="Toggle darkmode">Toggle darkmode</launch-dark-switch>

  
    <a href="https://github.com/holochain-gym/">Help and Feedback</a>
  
</div>

</rocket-navigation>

    
  </nav>
</rocket-drawer>

      
      
        <main class="markdown-body">
  
    <h1 id="basic-validation"><a class="anchor" href="#basic-validation"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Basic: Validation</h1>
<inline-notification type="tip" title="Useful reads">
  <ul>
    <li><a href="/concepts/validation-rules/">Validation Rules</a></li>
  </ul>
</inline-notification>
<h2 id="background"><a class="anchor" href="#background"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Background</h2>
<p>In this exercise we will implement validation. Validation ensures that only valid data ends up on
the chain used by an agent's hApp.</p>
<p>This hApp estimates work items. Agents can submit an <code>Estimate</code> with an estimate value:</p>
<pre class="language-rust"><code class="language-rust"><span class="token keyword">pub</span> <span class="token keyword">struct</span> Estimate <span class="token punctuation">{</span>
    item<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
    value<span class="token punctuation">:</span> u8<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Our hApp has one requirement: all estimates must conform to the agile estimation recommendation of
using <a href="https://en.wikipedia.org/wiki/Fibonacci_number">Fibonacci numbers</a> less than or equal to 21.
(Here's an <a href="https://www.mountaingoatsoftware.com/blog/why-the-fibonacci-sequence-works-well-for-estimating">agile estimation Fibonacci explainer</a>).</p>
<pre class="language-rust"><code class="language-rust"><span class="token keyword">let</span> valid_estimate_values <span class="token operator">=</span> <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre>
<p>So in addition to the <code>add_estimate</code> zome function allowing us to create new estimates, we will also
implement the <code>validate</code> zome function that ensures that only valid data is saved to the source chain.</p>
<h2 id="about-validation"><a class="anchor" href="#about-validation"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>About validation</h2>
<p>If your zome implements a <code>validate</code> function, the conductor will call it for all changes to the DHT
for any cell containing the zome.</p>
<p>The argument your <code>validate</code> will receive is an
<a href="https://docs.rs/holochain_integrity_types/0.0.5/holochain_integrity_types/op/enum.Op.html"><code>holochain_integrity_types::op::Op</code></a>.</p>
<p><code>Op</code> is short for "DHT Operation". Every time you commit some action in your source chain, multiple DHT Operations are created and published to different parts of the DHT. This is because different read operations need to read different parts of the DHT, so we need to store the same element in multiple places.</p>
<p>This is a table describing the "DhtOps" that each action creates:</p>















































<table><thead><tr><th>Chain Action</th><th>DhtOp Name</th><th>Targeted hash basis</th><th>Payload</th><th>Metadata</th></tr></thead><tbody><tr><td>create_content(content)</td><td>RegisterAgentActivity<br> StoreRecord<br> StoreContent</td><td>Author's public key<br> Hash of the action <br> Hash of the content</td><td>Action <br> Record <br> Record</td><td>Hash of the action <br> -  <br> -</td></tr><tr><td>update_content(original_action_hash, new_content)</td><td>RegisterAgentActivity<br> StoreRecord<br> StoreContent<br> RegisterContentUpdate<br> RegisterRecordUpdate</td><td>Author's public key<br> Hash of the action <br> Hash of the content <br> Hash of the original content <br> Hash of the original action</td><td>New action <br> New Record <br> New record <br> New action <br> New action</td><td>Hash of the action <br> - <br> New content updates old content <br> Old content is updated to new content <br> Old action is updated to new action</td></tr><tr><td>bury_content(action_hash)</td><td>RegisterAgentActivity<br> StoreRecord<br> RegisterContentDelete<br> RegisterRecordDelete</td><td>Author's public key <br> Hash of the new action <br> Hash of the deleted content <br> Hash of the deleted action</td><td>New action <br> New Record <br> New action <br> New action</td><td>Hash of the action <br> - <br> Old content deleted by new action <br> Old action deleted by new action</td></tr><tr><td>create_link(base, target, tag)</td><td>RegisterAgentActivity<br> StoreRecord<br> RegisterCreateLink</td><td>Author's public key <br> Hash of the new action <br> "Base" hash</td><td>Action <br> Record <br> Action</td><td>Hash of the action <br> - <br> Link from the base to the target hash</td></tr><tr><td>delete_link(create_link_action_hash)</td><td>RegisterAgentActivity<br> StoreRecord<br> RegisterDeleteLink</td><td>Author's public key <br> Hash of the new action <br> Hash of the deleted create link action hash</td><td>Action <br> Record <br> Action</td><td>Hash of the action <br> - <br> Deleted link sent to tombstone</td></tr></tbody></table>
<p>After the action is committed to the source chain and published to the DHT in those different parts, the agents who receive those publish requests first have to validate that the DHT Operation is actually valid and playing by the rules of the game. After making sure that the change is valid, the agents will start to answer DHT read operations (<code>get</code>, <code>get_links</code>, etc.) with its data.</p>
<p>To know more about how to implement validation rules in your application, read <a href="https://docs.rs/holochain_integrity_types/0.0.5/holochain_integrity_types/op/enum.Op.html#producing-operations">this documentation</a>.</p>
<h2 id="exercise"><a class="anchor" href="#exercise"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Exercise</h2>
<p>We have provided the basic structure of validating a DNA that allows the creation of <code>Estimate</code>s.
Your task is to add the validation business logic for the <code>Estimate</code>s:</p>
<ol>
<li>An Estimate value must be an agile Fibonacci value.</li>
<li>An Estimate's <code>item</code> must be non-empty.</li>
</ol>
<h3 id="extra-credit"><a class="anchor" href="#extra-credit"><svg class="octicon octicon-link" viewBox="0 0 16 16" aria-hidden="true" width="16" height="16"><path fill-rule="evenodd" d="M7.775 3.275a.75.75 0 001.06 1.06l1.25-1.25a2 2 0 112.83 2.83l-2.5 2.5a2 2 0 01-2.83 0 .75.75 0 00-1.06 1.06 3.5 3.5 0 004.95 0l2.5-2.5a3.5 3.5 0 00-4.95-4.95l-1.25 1.25zm-4.69 9.64a2 2 0 010-2.83l2.5-2.5a2 2 0 012.83 0 .75.75 0 001.06-1.06 3.5 3.5 0 00-4.95 0l-2.5 2.5a3.5 3.5 0 004.95 4.95l1.25-1.25a.75.75 0 00-1.06-1.06l-1.25 1.25a2 2 0 01-2.83 0z"></path></svg></a>Extra credit</h3>
<p>Add this validation rule:</p>
<ul>
<li>Each agent can only estimate the same <code>item</code> once.</li>
</ul>

  
    <div class="content-footer">
  <p>
    Caught a mistake or want to contribute to the documentation?
    <a href="https://github.com/holochain-gym/holochain-gym.github.io/edit/main/./docs/developers/basic/validation.md">Edit this page on GitHub!</a>
  </p>
</div>

  
</main>

      
    </div>
  </div>


    
      <footer id="main-footer">
  
    

  
    <div id="footer-menu">
  <div class="content-area">
    
      <nav>
        <h3>Holochain</h3>
        <ul>
          
            <li>
              <a href="https://developer.holochain.org/docs/references/">Documentation</a>
            </li>
          
            <li>
              <a href="https://forum.holochain.org">Forum</a>
            </li>
          
        </ul>
      </nav>
    
      <nav>
        <h3>Gym</h3>
        <ul>
          
            <li>
              <a href="https://forum.holochain.org/c/learning-library/gym/133">Help and Feedback</a>
            </li>
          
            <li>
              <a href="https://github.com/holochain-gym/holochain-gym.github.io/issues">Tasks for Contributors to the Gym</a>
            </li>
          
        </ul>
      </nav>
    
      <nav>
        <h3>Discover</h3>
        <ul>
          
            <li>
              <a href="https://holochain-open-dev.github.io/blog">Holochain Open Dev Blog</a>
            </li>
          
            <li>
              <a href="https://github.com/holochain-open-dev">Open Source Modules</a>
            </li>
          
        </ul>
      </nav>
    
      <nav>
        <h3>License</h3>
        <ul>
          
            <li>
              <a href="http://creativecommons.org/licenses/by/4.0/">This work is licensed under</a>
            </li>
          
            <li>
              <a href="http://creativecommons.org/licenses/by/4.0/">a Creative 
Commons Attribution 4.0</a>
            </li>
          
            <li>
              <a href="http://creativecommons.org/licenses/by/4.0/">International License</a>
            </li>
          
        </ul>
      </nav>
    
  </div>
</div>

  
</footer>

    

    
  


  

<script>
  window.__rocketServiceWorkerUrl = '/service-worker.js';
</script>






  



  


<script type="module" src="../../../81b16c1a.js"></script>
<script type="module" src="../../../d15d5a5d.js" inject-service-worker=""></script>

</body></html>